(window.webpackJsonp=window.webpackJsonp||[]).push([["fyFE"],{fyFE:function(t,e,o){"use strict";o.r(e);var n=o("t3Un");var a={data:function(){return{coupon:{},dialogFormVisible:!1,coupons:[],listLoading:!0,dialogStatus:"",textMap:{update:"编辑优惠券",create:"创建优惠券"},typeList:[{value:1,label:"满减"},{value:2,label:"普通红包"},{value:3,label:"不叠加红包"}]}},created:function(){this.getListCoupon()},methods:{handleCreate:function(){this.dialogFormVisible=!0,this.dialogStatus="create"},cancel:function(){this.dialogFormVisible=!1},getListCoupon:function(){var t=this;Object(n.a)({url:"/coupon/list",method:"post"}).then(function(e){console.log(e);var o=e.data;0==o.errno&&(t.coupons=o.list,t.listLoading=!1)}).catch(function(e){console.log(e),t.listLoading=!1})},createData:function(){var t=this,e=this.coupon;console.log(this.formatTime(new Date(e.startTime))),function(t){return Object(n.a)({url:"/coupon/create",method:"post",data:t})}(e).then(function(e){0==e.data.errno&&(t.dialogFormVisible=!1,t.getListCoupon(),t.$message({message:"添加成功！",type:"success"}))}).catch(function(t){console.log(t)})},handleUpdate:function(t){this.dialogFormVisible=!0,this.dialogStatus="update",console.log(t),this.coupon=t},updateData:function(){var t=this;(function(t){return Object(n.a)({url:"/coupon/update",method:"post",data:t})})(this.coupon).then(function(e){0==e.data.errno&&(t.dialogFormVisible=!1,t.getListCoupon(),t.$message({message:"修改成功！",type:"success"}),t.dialogFormVisible=!1)}).catch(function(e){console.log(e),t.dialogFormVisible=!1})},handleDelete:function(t){var e=this;this.$confirm("确认删除此商品?","删除商品",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o={couponId:t.couponId};console.log(o),function(t){return Object(n.a)({url:"/coupon/delete",method:"post",data:t})}(o).then(function(t){console.log(t),0==t.data.errno&&(e.getListCoupon(),e.$message({type:"success",message:"删除成功!"}))}).catch(function(t){console.log(t),e.$message({type:"danger",message:"删除失败!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},formatTime:function(t){console.log(t);var e=t.getFullYear(),o=t.getMonth()+1,n=t.getDate(),a=t.getHours(),l=t.getMinutes(),i=t.getSeconds();return[e,o,n].map(this.formatNumber).join("-")+" "+[a,l,i].map(this.formatNumber).join(":")},formatNumber:function(t){return(t=t.toString())[1]?t:"0"+t}}},l=o("ZrdR"),i=Object(l.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("h4",[t._v("优惠券管理")]),t._v(" "),o("el-card",[o("div",{staticClass:"filter-container"},[o("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加")])],1)]),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.coupons}},[o("el-table-column",{attrs:{prop:"title",label:"名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"targetMoney",label:"满足的金额"}}),t._v(" "),o("el-table-column",{attrs:{prop:"discountMoney",label:"优惠金额"}}),t._v(" "),o("el-table-column",{attrs:{prop:"startTime",label:"开始时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"number",label:"发放数量"}}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(o){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"coupon",attrs:{model:t.coupon,"label-width":"100px"}},[o("el-form-item",[o("el-select",{attrs:{placeholder:"优惠类型"},model:{value:t.coupon.types,callback:function(e){t.$set(t.coupon,"types",e)},expression:"coupon.types"}},t._l(t.typeList,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"优惠券名称"}},[o("el-input",{model:{value:t.coupon.title,callback:function(e){t.$set(t.coupon,"title",e)},expression:"coupon.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"满足金额"}},[o("el-input",{model:{value:t.coupon.targetMoney,callback:function(e){t.$set(t.coupon,"targetMoney",e)},expression:"coupon.targetMoney"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"优惠金额",prop:"discountMoney"}},[o("el-input",{model:{value:t.coupon.discountMoney,callback:function(e){t.$set(t.coupon,"discountMoney",e)},expression:"coupon.discountMoney"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"发放数量"}},[o("el-input",{model:{value:t.coupon.number,callback:function(e){t.$set(t.coupon,"number",e)},expression:"coupon.number"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"优惠开始时间",prop:"srartTime"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.coupon.startTime,callback:function(e){t.$set(t.coupon,"startTime",e)},expression:"coupon.startTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"优惠结束时间",prop:"srartTime"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间"},model:{value:t.coupon.endTime,callback:function(e){t.$set(t.coupon,"endTime",e)},expression:"coupon.endTime"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):o("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1)],1)},[],!1,null,null,null);i.options.__file="list.vue";e.default=i.exports}}]);