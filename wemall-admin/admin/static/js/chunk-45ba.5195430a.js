(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-45ba"],{MKJu:function(e,t,a){"use strict";var o=a("iY+/");a.n(o).a},"iY+/":function(e,t,a){},oX5y:function(e,t,a){"use strict";a.r(t);var o=a("xAVR"),l=a("rs3x"),r={data:function(){return{uploadPath:l.a,listCat:[],dialogFormVisible:!1,category:{id:"",name:"",level:"",pid:""},listLoading:!0,dialogStatus:"",textMap:{update:"编辑类目",create:"创建类目"},loading:!1}},computed:{headers:function(){return{"X-Upload-Type":"goods"}}},created:function(){this.getListCategory()},methods:{getListCategory:function(){var e=this;console.log(this.$store.getters.storagePath),Object(o.c)().then(function(t){var a=t.data;console.log(a),0==a.errno&&(e.listCat=a.result,e.listLoading=!1)}).catch(function(t){console.log(t),e.listLoading=!1})},handleUpdate:function(e){console.log(e),this.dialogStatus="update",this.dialogFormVisible=!0,this.category=e},handleCreate:function(){this.dialogStatus="create",this.dialogFormVisible=!0},createData:function(){var e=this;console.log(this.category),Object(o.a)(this.category).then(function(t){var a=t.data;console.log(a),0==a.errno&&(e.dialogFormVisible=!1,e.getListCategory(),e.$refs.category.resetFields(),e.$message({message:"添加成功！",type:"success"}))}).catch(function(t){e.$message.error("添加失败！")})},updateData:function(){var e=this;Object(o.d)(this.category).then(function(t){var a=t.data;console.log(a),0==a.errno&&(e.dialogFormVisible=!1,e.getListCategory(),e.$message({message:"更新成功！",type:"success"}),e.$refs.category.resetFields())}).catch(function(t){console.log(t),e.$message.error("更新失败！")})},handleDelete:function(e){var t=this;this.$confirm("确认删除此目录?","删除目录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:e.id,level:e.level,pid:e.pid};console.log(a),Object(o.b)(a).then(function(e){console.log(e);var a=e.data;0==a.errno?(t.getListCategory(),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"danger",message:a.errmsg})}).catch(function(e){console.log(e),t.$message({type:"danger",message:e.data.errmsg})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},cancel:function(){this.dialogFormVisible=!1},beforeUpload:function(e){console.log(e.type);var t="image/jpg"===e.type||"image/png"===e.type||"image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG、JPEG 或 PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a&&(this.loading=!0),t&&a},errorUpload:function(){this.loading=!1},uploadPicUrl:function(e){console.log(e),this.category.picUrl=this.$store.getters.storagePath+"goods/"+e.result,this.loading=!1,console.log(this.category.picUrl)}}},i=(a("MKJu"),a("ZrdR")),n=Object(i.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("h4",[e._v("类目管理")]),e._v(" "),a("el-card",[a("div",{staticClass:"filter-container"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加")])],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.listCat,"row-key":"id",border:"","element-loading-text":"正在加载中。。。","tree-props":{children:"children"}}},[a("el-table-column",{attrs:{prop:"id",label:"类目id",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"类目名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"picUrl",label:"类目图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.picUrl?a("img",{attrs:{src:t.row.picUrl,width:"50",height:"50"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"level",label:"类目级别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"L1"===t.row.level?"primary":"success"}},[e._v(e._s("L1"===t.row.level?"一级类目":"二级类目"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"category",attrs:{model:e.category,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"类目名称",prop:"name"}},[a("el-input",{model:{value:e.category.name,callback:function(t){e.$set(e.category,"name",t)},expression:"category.name"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{label:"类目图片",prop:"name"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadPath,"show-file-list":!1,"on-success":e.uploadPicUrl,"before-upload":e.beforeUpload,"on-error":e.errorUpload,headers:e.headers,"element-loading-text":"上传图片中",accept:".jpg,.jpeg,.png,.gif"}},[e.category.picUrl?a("img",{staticClass:"avatar",attrs:{src:e.category.picUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"类目级别",prop:"level"}},[a("el-select",{attrs:{placeholder:"请选择类目级别"},model:{value:e.category.level,callback:function(t){e.$set(e.category,"level",t)},expression:"category.level"}},[a("el-option",{attrs:{label:"一级类目",value:"L1"}}),e._v(" "),a("el-option",{attrs:{label:"二级目录",value:"L2"}})],1)],1),e._v(" "),"L2"===e.category.level?a("el-form-item",{attrs:{label:"父级类目",prop:"pid"}},[a("el-select",{model:{value:e.category.pid,callback:function(t){e.$set(e.category,"pid",t)},expression:"category.pid"}},e._l(e.listCat,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.createData}},[e._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("确定")])],1)],1)],1)},[],!1,null,null,null);n.options.__file="category.vue";t.default=n.exports},rs3x:function(e,t,a){"use strict";a.d(t,"a",function(){return o});a("t3Un");var o="http://localhost:8081/admin/storage/upload"},xAVR:function(e,t,a){"use strict";a.d(t,"c",function(){return l}),a.d(t,"a",function(){return r}),a.d(t,"d",function(){return i}),a.d(t,"b",function(){return n});var o=a("t3Un");function l(e){return Object(o.a)({url:"/category/list",method:"get",params:e})}function r(e){return Object(o.a)({url:"/category/create",method:"post",data:e})}function i(e){return Object(o.a)({url:"/category/update",method:"post",data:e})}function n(e){return Object(o.a)({url:"/category/delete",method:"post",data:e})}}}]);