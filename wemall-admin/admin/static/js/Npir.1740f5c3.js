(window.webpackJsonp=window.webpackJsonp||[]).push([["Npir"],{Npir:function(e,t,a){"use strict";a.r(t);var r=a("t3Un");function l(e){return Object(r.a)({url:"/order/list",method:"post",data:e})}var o={data:function(){return{order:{status:0},orderDetail:{},dialogFormVisible:!1,listOrder:[],listLoading:!0,options:[{value:"1",label:"待付款"},{value:"2",label:"待发货"},{value:"3",label:"待收货"},{value:"4",label:"待退款"},{value:"5",label:"已退款"},{value:"0",label:"全部"}],statused:["已完结","待付款","待发货","待收货","待退款","已退款"],tag:["","success","primary","info","danger","warning"],changeInfo:{},currentPage:1,total:0,multipleSelection:[]}},created:function(){this.getListOrder()},methods:{handleCurrentChange:function(e){console.log("当前改变："+e),this.currentPage=e,this.search(),this.currentPage=1},getListOrder:function(){var e=this,t={},a=new Date,r=a.getFullYear(),o=a.getMonth(),n=a.getDate(),i=this.currentPage;t.createTime=this.formatTime(new Date(r,o,n)),t.endTime=this.formatTime(new Date),t.status=0,t.page=i,l({order:t}).then(function(t){if(console.log(t),0==t.data.errno){var a=t.data.result;e.total=a.count,e.listOrder=a.list,e.listLoading=!1}}).catch(function(e){})},handleOrderDetail:function(e){console.log(e),this.changeInfo=e,this.orderDetail=e.orderDetail,this.dialogFormVisible=!0},exportExcel:function(){window.location.href="http://localhost:8081/admin/order/export"},updateData:function(){},cancel:function(){this.dialogFormVisible=!1},search:function(){var e=this,t={};if(console.log(this.order),!this.order.createTime){var a=new Date,r=a.getFullYear(),o=a.getMonth(),n=a.getDate(),i=this.currentPage;this.order.createTime=this.formatTime(new Date(r,o,n)),this.order.endTime=this.formatTime(a),this.order.page=i}t.createTime=this.formatTime(new Date(this.order.createTime)),t.endTime=this.formatTime(new Date(this.order.endTime)),t.status=this.order.status,t.page=this.currentPage,console.log(this.order),l({order:t}).then(function(t){if(console.log(t),0==t.data.errno){var a=t.data.result;e.total=a.count,e.listOrder=a.list,e.listLoading=!1}}).catch(function(e){console.log(e)})},deliver:function(e){var t=this;this.$confirm("确认更新状态至发货?","发货确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:e.id,status:3,userId:e.userId,orderId:e.orderId,packupCode:e.packupCode,deliveryWay:e.deliveryWay};console.log(a),function(e){return Object(r.a)({url:"/order/update",method:"post",data:e})}(a).then(function(e){console.log(e),0==e.data.errno&&(t.search(),t.$message({type:"success",message:"发货成功!"}))}).catch(function(e){console.log(e),t.$message({type:"danger",message:"发货失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消"})})},formatTime:function(e){console.log(e);var t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate(),l=e.getHours(),o=e.getMinutes(),n=e.getSeconds();return[t,a,r].map(this.formatNumber).join("-")+" "+[l,o,n].map(this.formatNumber).join(":")},formatNumber:function(e){return(e=e.toString())[1]?e:"0"+e},toggleSelection:function(e){var t=this;console.log(e),e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection(),console.log(this.multipleTable)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)}}},n=a("ZrdR"),i=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-card",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.order.status,callback:function(t){e.$set(e.order,"status",t)},expression:"order.status"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-date-picker",{attrs:{type:"datetime",placeholder:"开始日期时间"},model:{value:e.order.createTime,callback:function(t){e.$set(e.order,"createTime",t)},expression:"order.createTime"}}),e._v(" "),a("el-date-picker",{attrs:{type:"datetime",placeholder:"结束日期时间"},model:{value:e.order.endTime,callback:function(t){e.$set(e.order,"endTime",t)},expression:"order.endTime"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("立即查找")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出订单")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.listOrder,"row-key":"id",border:"","element-loading-text":"正在加载中。。。"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderId",label:"订单编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalMoney",label:"订单总价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payMoney",label:"实付金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"returnMoney",label:"返现金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.tag[t.row.status]}},[e._v(e._s(e.statused[t.row.status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.deliver(t.row)}}},[e._v("发货")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleOrderDetail(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"订单详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderDetail,stripe:""}},[a("el-table-column",{attrs:{prop:"orderId",label:"订单编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"商品数量"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sellPrice",label:"销售价格"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.deliver}},[e._v("发货")])],1)],1),e._v(" "),a("div",[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,layout:"total,prev, pager, next",total:e.total,"page-size":10},on:{"current-change":e.handleCurrentChange}})],1)],1)},[],!1,null,null,null);i.options.__file="list.vue";t.default=i.exports}}]);